function method(f,l){return function(){f[l].apply(f,arguments)}}var StopIteration={toString:function(){return"StopIteration"}};function forEach(f,l){if(f.next)try{for(;;)l(f.next())}catch(j){if(j!=StopIteration)throw j;}else for(var m=0;m<f.length;m++)l(f[m])}function map(f,l){var j=[];forEach(f,function(m){j.push(l(m))});return j}function matcher(f){return function(l){return f.test(l)}}function hasClass(f,l){var j=f.className;return j&&RegExp("(^| )"+l+"($| )").test(j)}
function insertAfter(f,l){l.parentNode.insertBefore(f,l.nextSibling);return f}function removeElement(f){f.parentNode&&f.parentNode.removeChild(f)}function clearElement(f){for(;f.firstChild;)f.removeChild(f.firstChild)}function isAncestor(f,l){for(;l=l.parentNode;)if(f==l)return true;return false}var nbsp="\u00a0",matching={"{":"}","[":"]","(":")","}":"{","]":"[",")":"("};
function normalizeEvent(f){if(!f.stopPropagation){f.stopPropagation=function(){this.cancelBubble=true};f.preventDefault=function(){this.returnValue=false}}if(!f.stop)f.stop=function(){this.stopPropagation();this.preventDefault()};if(f.type=="keypress"){f.code=f.charCode==null?f.keyCode:f.charCode;f.character=String.fromCharCode(f.code)}return f}
function addEventHandler(f,l,j,m){function n(r){j(normalizeEvent(r||window.event))}if(typeof f.addEventListener=="function"){f.addEventListener(l,n,false);if(m)return function(){f.removeEventListener(l,n,false)}}else{f.attachEvent("on"+l,n);if(m)return function(){f.detachEvent("on"+l,n)}}}function nodeText(f){return f.textContent||f.innerText||f.nodeValue||""}function nodeTop(f){for(var l=0;f.offsetParent;){l+=f.offsetTop;f=f.offsetParent}return l}
function isBR(f){f=f.nodeName;return f=="BR"||f=="br"}function isSpan(f){f=f.nodeName;return f=="SPAN"||f=="span"};var stringStream=function(f){function l(){for(;m==j.length;){n+=j;j="";m=0;try{j=f.next()}catch(r){if(r!=StopIteration)throw r;else return false}}return true}var j="",m=0,n="";return{peek:function(){if(!l())return null;return j.charAt(m)},next:function(){if(!l())if(n.length>0)throw"End of stringstream reached without emptying buffer ('"+n+"').";else throw StopIteration;return j.charAt(m++)},get:function(){var r=n;n="";if(m>0){r+=j.slice(0,m);j=j.slice(m);m=0}return r},push:function(r){j=j.slice(0,
m)+r+j.slice(m)},lookAhead:function(r,u,v,b){function a(i){return b?i.toLowerCase():i}r=a(r);var d=false,c=n,e=m;for(v&&this.nextWhileMatches(/[\s\u00a0]/);;){v=m+r.length;var h=j.length-m;if(v<=j.length){d=r==a(j.slice(m,v));m=v;break}else if(r.slice(0,h)==a(j.slice(m))){n+=j;j="";try{j=f.next()}catch(g){break}m=0;r=r.slice(h)}else break}if(!(d&&u)){j=n.slice(c.length)+j;m=e;n=c}return d},more:function(){return this.peek()!==null},applies:function(r){var u=this.peek();return u!==null&&r(u)},nextWhile:function(r){for(var u;(u=
this.peek())!==null&&r(u);)this.next()},matches:function(r){var u=this.peek();return u!==null&&r.test(u)},nextWhileMatches:function(r){for(var u;(u=this.peek())!==null&&r.test(u);)this.next()},equals:function(r){return r===this.peek()},endOfLine:function(){var r=this.peek();return r==null||r=="\n"}}};var select={};
(function(){function f(a,d){for(;a&&a.parentNode!=d;)a=a.parentNode;return a}function l(a,d){for(;!a.previousSibling&&a.parentNode!=d;)a=a.parentNode;return f(a.previousSibling,d)}select.ie_selection=document.selection&&document.selection.createRangeCollection;select.scrollToNode=function(a,d){if(a){var c=a,e=c.ownerDocument,h=e.body,g=e.defaultView||e.parentWindow;e=e.documentElement;for(var i=!c.nextSibling||!c.nextSibling.nextSibling||!c.nextSibling.nextSibling.nextSibling,k=0;c&&!c.offsetTop;){k++;
c=c.previousSibling}if(k==0)i=false;if(!(webkit&&c&&c.offsetTop==5&&c.offsetLeft==5)){k=k*(c?c.offsetHeight:0);var p=0,s=a?a.offsetWidth:0;for(c=c;c&&c.offsetParent;){k+=c.offsetTop;isBR(c)||(p+=c.offsetLeft);c=c.offsetParent}c=h.scrollLeft||e.scrollLeft||0;h=h.scrollTop||e.scrollTop||0;var o=false,q=g.innerWidth||e.clientWidth||0;if(d||s<q){if(d){var x=select.offsetInNode(g,a),y=nodeText(a).length;if(y)p+=s*(x/y)}s=p-c;if(s<0||s>q){c=p;o=true}}p=k-h;if(p<0||i||p>(g.innerHeight||e.clientHeight||0)-
50){h=i?1E6:k;o=true}o&&g.scrollTo(c,h)}}};select.scrollToCursor=function(a){select.scrollToNode(select.selectionTopNode(a,true)||a.firstChild,true)};var j=null;select.snapshotChanged=function(){if(j)j.changed=true};select.snapshotReplaceNode=function(a,d,c,e){function h(g){if(a==g.node){j.changed=true;if(c&&g.offset>c)g.offset-=c;else{g.node=d;g.offset+=e||0}}}if(j){h(j.start);h(j.end)}};select.snapshotMove=function(a,d,c,e,h){function g(i){if(a==i.node&&(!h||i.offset==0)){j.changed=true;i.node=
d;i.offset=e?Math.max(0,i.offset+c):c}}if(j){g(j.start);g(j.end)}};if(select.ie_selection){var m=function(a,d){function c(o){for(var q=null;!q&&o;){q=o.nextSibling;o=o.parentNode}return e(q)}function e(o){for(;o&&o.firstChild;)o=o.firstChild;return{node:o,offset:0}}var h=a.document.selection.createRange();h.collapse(d);var g=h.parentElement();if(!isAncestor(a.document.body,g))return null;if(!g.firstChild)return e(g);var i=h.duplicate();i.moveToElementText(g);i.collapse(true);for(var k=g.firstChild;k;k=
k.nextSibling){if(k.nodeType==3){var p=k.nodeValue.length;i.move("character",p)}else{i.moveToElementText(k);i.collapse(false)}var s=h.compareEndPoints("StartToStart",i);if(s==0)return c(k);if(s!=1){if(k.nodeType!=3)return e(k);i.setEndPoint("StartToEnd",h);return{node:k,offset:p-i.text.length}}}return c(g)};select.markSelection=function(a){j=null;if(a.document.selection){var d=m(a,true),c=m(a,false);if(d&&c)j={start:d,end:c,window:a,changed:false}}};select.selectMarked=function(){function a(h){var g=
d.body.createTextRange(),i=h.node;if(i)if(i.nodeType==3){g.moveToElementText(i.parentNode);for(h=h.offset;i.previousSibling;){i=i.previousSibling;h+=(i.innerText||"").length}g.move("character",h)}else{g.moveToElementText(i);g.collapse(true)}else{g.moveToElementText(j.window.document.body);g.collapse(false)}return g}if(j&&j.changed){var d=j.window.document,c=a(j.start),e=a(j.end);c.setEndPoint("StartToEnd",e);c.select()}};select.offsetInNode=function(a,d){var c=a.document.selection;if(!c)return 0;
c=c.createRange();var e=c.duplicate();try{e.moveToElementText(d)}catch(h){return 0}c.setEndPoint("StartToStart",e);return c.text.length};select.selectionTopNode=function(a,d){function c(p,s){if(s.nodeType==3){for(var o=0,q=s.previousSibling;q&&q.nodeType==3;){o+=q.nodeValue.length;q=q.previousSibling}if(q){try{p.moveToElementText(q)}catch(x){return false}p.collapse(false)}else p.moveToElementText(s.parentNode);o&&p.move("character",o)}else try{p.moveToElementText(s)}catch(y){return false}return true}
var e=a.ownerDocument.selection;if(!e)return false;e=e.createRange();var h=e.duplicate();e.collapse(d);var g=e.parentElement();if(g&&isAncestor(a,g)){h.moveToElementText(g);if(e.compareEndPoints("StartToStart",h)==1)return f(g,a)}d=0;for(g=a.childNodes.length-1;d<g;){var i=Math.ceil((g+d)/2),k=a.childNodes[i];if(!k)return false;if(!c(h,k))return false;if(e.compareEndPoints("StartToStart",h)==1)d=i;else g=i-1}return a.childNodes[d]||null};select.focusAfterNode=function(a,d){var c=d.ownerDocument.body.createTextRange();
c.moveToElementText(a||d);c.collapse(!a);c.select()};select.somethingSelected=function(a){return(a=a.document.selection)&&a.createRange().text!=""};var n=function(a,d){var c=a.document.selection;if(c){c=c.createRange();c.pasteHTML(d);c.collapse(false);c.select()}};select.insertNewlineAtCursor=function(a){n(a,"<br>")};select.insertTabAtCursor=function(a){n(a,"\u00a0\u00a0\u00a0\u00a0")};select.cursorPos=function(a,d){var c=a.ownerDocument.selection;if(!c)return null;for(var e=select.selectionTopNode(a,
d);e&&!isBR(e);)e=e.previousSibling;c=c.createRange();var h=c.duplicate();c.collapse(d);if(e){h.moveToElementText(e);h.collapse(false)}else{try{h.moveToElementText(a)}catch(g){return null}h.collapse(true)}c.setEndPoint("StartToStart",h);return{node:e,offset:c.text.length}};select.setCursorPos=function(a,d,c){function e(g){var i=a.ownerDocument.body.createTextRange();if(g.node){i.moveToElementText(g.node);i.collapse(false)}else{i.moveToElementText(a);i.collapse(true)}i.move("character",g.offset);return i}
var h=e(d);c&&c!=d&&h.setEndPoint("EndToEnd",e(c));h.select()};select.getBookmark=function(a){var d=select.cursorPos(a,true);a=select.cursorPos(a,false);if(d&&a)return{from:d,to:a}};select.setBookmark=function(a,d){d&&select.setCursorPos(a,d.from,d.to)}}else{var r=function(a,d){for(;a.nodeType!=3&&!isBR(a);){var c=a.childNodes[d]||a.nextSibling;for(d=0;!c&&a.parentNode;){a=a.parentNode;c=a.nextSibling}a=c;if(!c)break}return{node:a,offset:d}};select.markSelection=function(a){var d=a.getSelection();
if(!d||d.rangeCount==0)return j=null;d=d.getRangeAt(0);j={start:r(d.startContainer,d.startOffset),end:r(d.endContainer,d.endOffset),window:a,changed:false}};select.selectMarked=function(){function a(){if(c.start.node==c.end.node&&c.start.offset==c.end.offset){var g=c.window.getSelection();if(!g||g.rangeCount==0)return true;g=g.getRangeAt(0);g=r(g.startContainer,g.startOffset);return c.start.node!=g.node||c.start.offset!=g.offset}}function d(g,i){if(g.node)g.offset==0?h["set"+i+"Before"](g.node):h["set"+
i](g.node,g.offset);else h.setStartAfter(e.document.body.lastChild||e.document.body)}var c=j;if(c&&(c.changed||webkit&&a())){var e=c.window,h=e.document.createRange();d(c.end,"End");d(c.start,"Start");u(h,e)}};var u=function(a,d){var c=d.getSelection();if(c){c.removeAllRanges();c.addRange(a)}},v=function(a){a=a.getSelection();return!a||a.rangeCount==0?false:a.getRangeAt(0)};select.selectionTopNode=function(a,d){var c=v(a.ownerDocument.defaultView);if(!c)return false;var e=d?c.startContainer:c.endContainer,
h=d?c.startOffset:c.endOffset;window.opera&&!d&&c.endContainer==a&&c.endOffset==c.startOffset+1&&a.childNodes[c.startOffset]&&isBR(a.childNodes[c.startOffset])&&h--;return e.nodeType==3?h>0?f(e,a):l(e,a):e.nodeName.toUpperCase()=="HTML"?h==1?null:a.lastChild:e==a?h==0?null:e.childNodes[h-1]:h==e.childNodes.length?f(e,a):h==0?l(e,a):f(e.childNodes[h-1],a)};select.focusAfterNode=function(a,d){var c=d.ownerDocument.defaultView,e=c.document.createRange();e.setStartBefore(d.firstChild||d);if(a&&!a.firstChild)e.setEndAfter(a);
else a?e.setEnd(a,a.childNodes.length):e.setEndBefore(d.firstChild||d);e.collapse(false);u(e,c)};select.somethingSelected=function(a){return(a=v(a))&&!a.collapsed};select.offsetInNode=function(a,d){var c=v(a);if(!c)return 0;c=c.cloneRange();c.setStartBefore(d);return c.toString().length};var b=function(a,d){var c=v(a);if(c){c.deleteContents();c.insertNode(d);if(a.opera&&isBR(d)&&isSpan(d.parentNode)){c=d.nextSibling;var e=d.parentNode,h=e.parentNode;h.insertBefore(d,e.nextSibling);for(e="";c&&c.nodeType==
3;c=c.nextSibling){e+=c.nodeValue;removeElement(c)}h.insertBefore(makePartSpan(e,a.document),d.nextSibling)}c=a.document.createRange();c.selectNode(d);c.collapse(false);u(c,a)}};select.insertNewlineAtCursor=function(a){webkit?document.execCommand("insertLineBreak"):b(a,a.document.createElement("BR"))};select.insertTabAtCursor=function(a){b(a,a.document.createTextNode("\u00a0\u00a0\u00a0\u00a0"))};select.cursorPos=function(a,d){var c=v(window);if(c){for(var e=select.selectionTopNode(a,d);e&&!isBR(e);)e=
e.previousSibling;c=c.cloneRange();c.collapse(d);e?c.setStartAfter(e):c.setStartBefore(a);return{node:e,offset:c.toString().length}}};select.setCursorPos=function(a,d,c){function e(i,k,p){function s(y){y.nodeType==3?o.push(y):forEach(y.childNodes,s)}if(k==0&&i&&!i.nextSibling){g["set"+p+"After"](i);return true}if(i=i?i.nextSibling:a.firstChild){if(k==0){g["set"+p+"Before"](i);return true}for(var o=[];;){for(;i&&!o.length;){s(i);i=i.nextSibling}var q=o.shift();if(!q)return false;var x=q.nodeValue.length;
if(x>=k){g["set"+p](q,k);return true}k-=x}}}var h=a.ownerDocument.defaultView,g=h.document.createRange();c=c||d;e(c.node,c.offset,"End")&&e(d.node,d.offset,"Start")&&u(g,h)}}})();function UndoHistory(f,l,j,m){this.container=f;this.maxDepth=l;this.commitDelay=j;this.editor=m;this.parent=m.parent;this.last=this.first=f={text:"",from:null,to:null};this.firstTouched=false;this.history=[];this.redoHistory=[];this.touched=[]}
UndoHistory.prototype={scheduleCommit:function(){var f=this;this.parent.clearTimeout(this.commitTimeout);this.commitTimeout=this.parent.setTimeout(function(){f.tryCommit()},this.commitDelay)},touch:function(f){this.setTouched(f);this.scheduleCommit()},undo:function(){this.commit();if(this.history.length){var f=this.history.pop();this.redoHistory.push(this.updateTo(f,"applyChain"));this.notifyEnvironment();return this.chainNode(f)}},redo:function(){this.commit();if(this.redoHistory.length){var f=this.redoHistory.pop();
this.addUndoLevel(this.updateTo(f,"applyChain"));this.notifyEnvironment();return this.chainNode(f)}},clear:function(){this.history=[];this.redoHistory=[]},historySize:function(){return{undo:this.history.length,redo:this.redoHistory.length}},push:function(f,l,j){for(var m=[],n=0;n<j.length;n++){var r=n==j.length-1?l:this.container.ownerDocument.createElement("BR");m.push({from:f,to:r,text:cleanText(j[n])});f=r}this.pushChains([m],f==null&&l==null);this.notifyEnvironment()},pushChains:function(f,l){this.commit(l);
this.addUndoLevel(this.updateTo(f,"applyChain"));this.redoHistory=[]},chainNode:function(f){for(var l=0;l<f.length;l++){var j=f[l][0];if(j=j&&(j.from||j.to))return j}},reset:function(){this.history=[];this.redoHistory=[]},textAfter:function(f){return this.after(f).text},nodeAfter:function(f){return this.after(f).to},nodeBefore:function(f){return this.before(f).from},tryCommit:function(){if(window.UndoHistory)this.editor.highlightDirty()?this.commit(true):this.scheduleCommit()},commit:function(f){this.parent.clearTimeout(this.commitTimeout);
f||this.editor.highlightDirty(true);f=this.touchedChains();if(f.length){this.addUndoLevel(this.updateTo(f,"linkChain"));this.redoHistory=[];this.notifyEnvironment()}},updateTo:function(f,l){for(var j=[],m=[],n=0;n<f.length;n++){j.push(this.shadowChain(f[n]));m.push(this[l](f[n]))}l=="applyChain"&&this.notifyDirty(m);return j},notifyDirty:function(f){forEach(f,method(this.editor,"addDirtyNode"));this.editor.scheduleHighlight()},notifyEnvironment:function(){this.onChange&&this.onChange();window.frameElement&&
window.frameElement.CodeMirror.updateNumbers&&window.frameElement.CodeMirror.updateNumbers()},linkChain:function(f){for(var l=0;l<f.length;l++){var j=f[l];if(j.from)j.from.historyAfter=j;else this.first=j;if(j.to)j.to.historyBefore=j;else this.last=j}},after:function(f){return f?f.historyAfter:this.first},before:function(f){return f?f.historyBefore:this.last},setTouched:function(f){if(f){if(!f.historyTouched){this.touched.push(f);f.historyTouched=true}}else this.firstTouched=true},addUndoLevel:function(f){this.history.push(f);
this.history.length>this.maxDepth&&this.history.shift()},touchedChains:function(){function f(v,b){if(v)v.historyTemp=b;else n=b}function l(v){for(var b=[],a=v?v.nextSibling:m.container.firstChild;a&&!isBR(a);a=a.nextSibling)a.currentText&&b.push(a.currentText);return{from:v,to:a,text:cleanText(b.join(""))}}function j(v,b){for(var a=b+"Sibling",d=v[a];d&&!isBR(d);)d=d[a];return d}var m=this,n=null,r=[];m.firstTouched&&m.touched.push(null);forEach(m.touched,function(v){if(!(v&&v.parentNode!=m.container)){if(v)v.historyTouched=
false;else m.firstTouched=false;var b=l(v),a=m.after(v);if(!a||a.text!=b.text||a.to!=b.to){r.push(b);f(v,b)}}});var u=[];m.touched=[];forEach(r,function(v){if(v.from?v.from.historyTemp:n){for(var b=[],a=v.from,d=true;;){var c=a?a.historyTemp:n;if(!c)if(d)break;else c=l(a);b.unshift(c);f(a,null);if(!a)break;d=m.after(a);a=j(a,"previous")}a=v.to;for(d=m.before(v.from);;){if(!a)break;c=a?a.historyTemp:n;if(!c)if(d)break;else c=l(a);b.push(c);f(a,null);d=m.before(a);a=j(a,"next")}u.push(b)}});return u},
shadowChain:function(f){var l=[],j=this.after(f[0].from);for(f=f[f.length-1].to;;){l.push(j);j=j.to;if(!j||j==f)break;else j=j.historyAfter||this.before(f)}return l},applyChain:function(f){var l=select.cursorPos(this.container,false),j=this,m=f[0].from,n=f[f.length-1].to;(function(d,c){for(var e=d?d.nextSibling:j.container.firstChild;e!=c;){var h=e.nextSibling;removeElement(e);e=h}})(m,n);for(var r=0;r<f.length;r++){var u=f[r];r>0&&j.container.insertBefore(u.from,n);var v=makePartSpan(fixSpaces(u.text),
this.container.ownerDocument);j.container.insertBefore(v,n);if(l&&l.node==u.from){v=0;var b=this.after(u.from);if(b&&r==f.length-1){for(var a=0;a<l.offset&&u.text.charAt(a)==b.text.charAt(a);a++);if(l.offset>a)v=u.text.length-b.text.length}select.setCursorPos(this.container,{node:u.from,offset:Math.max(0,l.offset+v)})}else l&&r==f.length-1&&l.node&&l.node.parentNode!=this.container&&select.setCursorPos(this.container,{node:u.from,offset:u.text.length})}this.linkChain(f);return m}};var internetExplorer=document.selection&&window.ActiveXObject&&/MSIE/.test(navigator.userAgent),webkit=/AppleWebKit/.test(navigator.userAgent),safari=/Apple Computers, Inc/.test(navigator.vendor),gecko=/gecko\/(\d{8})/i.test(navigator.userAgent),brokenOpera=window.opera&&/Version\/10.[56]/.test(navigator.userAgent);function makeWhiteSpace(f){for(var l=[],j=true;f>0;f--){l.push(j||f==1?nbsp:" ");j^=true}return l.join("")}
function fixSpaces(f){if(f.charAt(0)==" ")f=nbsp+f.slice(1);return f.replace(/\t/g,function(){return makeWhiteSpace(indentUnit)}).replace(/[ \u00a0]{2,}/g,function(l){return makeWhiteSpace(l.length)})}function cleanText(f){return f.replace(/\u00a0/g," ")}function makePartSpan(f,l){var j=f;if(f.nodeType==3)j=f.nodeValue;else f=l.createTextNode(j);var m=l.createElement("SPAN");m.isPart=true;m.appendChild(f);m.currentText=j;return m}
var Editor=function(){function f(b){var a=makeWhiteSpace(indentUnit);return map(b.replace(/\t/g,a).replace(/\u00a0/g," ").replace(/\r\n?/g,"\n").split("\n"),fixSpaces)}function l(b,a){function d(g,i){if(g.nodeType==3){if((g.nodeValue=fixSpaces(g.nodeValue.replace(/\r/g,"").replace(/\n/g," "))).length)h=false;e.push(g)}else if(isBR(g)&&g.childNodes.length==0){h=true;e.push(g)}else{for(var k=g.firstChild;k;k=k.nextSibling)d(k);if(!h&&v.hasOwnProperty(g.nodeName.toUpperCase())){h=true;if(!a||!i)e.push(c.createElement("BR"))}}}
var c=b.ownerDocument,e=[],h=true;d(b,true);return e}function j(b){function a(g){var i=g.parentNode,k=g.nextSibling;return function(p){i.insertBefore(p,k)}}var d=b.ownerDocument,c=[],e=null,h=true;return{next:function(){if(!b)throw StopIteration;var g=b;b=g.nextSibling;var i;if(g.isPart&&g.childNodes.length==1&&g.firstChild.nodeType==3){g.currentText=g.firstChild.nodeValue;i=!/[\n\t\r]/.test(g.currentText)}else i=false;if(i){c.push(g);h=false;return g.currentText}else if(isBR(g)){h&&window.opera&&
g.parentNode.insertBefore(makePartSpan("",d),g);c.push(g);h=true;return"\n"}else{i=!g.nextSibling;e=a(g);removeElement(g);g=l(g,i);for(i=0;i<g.length;i++){var k=g,p=i,s=g[i],o="\n";if(s.nodeType==3){select.snapshotChanged();s=makePartSpan(s,d);o=s.currentText;h=false}else{h&&window.opera&&e(makePartSpan("",d));h=true}s.dirty=true;c.push(s);e(s);k[p]=o}return g.join("")}},nodes:c}}function m(b){for(;b&&!isBR(b);)b=b.previousSibling;return b}function n(b,a){if(b){if(isBR(b))b=b.nextSibling}else b=a.firstChild;
for(;b&&!isBR(b);)b=b.nextSibling;return b}function r(b,a,d,c){function e(g){g=cleanText(b.history.textAfter(g));return c?g.toLowerCase():g}this.editor=b;this.history=b.history;this.history.commit();this.valid=!!a;this.atOccurrence=false;if(c==undefined)c=a==a.toLowerCase();if(d&&typeof d=="object"&&typeof d.character=="number"){b.checkLine(d.line);d={node:d.line,offset:d.character};this.pos={from:d,to:d}}else if(d)this.pos={from:select.cursorPos(b.container,true),to:select.cursorPos(b.container,
false)};else{d={node:null,offset:0};this.pos={from:d,to:d}}var h=(this.caseFold?a.toLowerCase():a).split("\n");this.matches=h.length==1?function(g,i,k){var p=e(i),s=a.length,o;if(g?k>=s&&(o=p.lastIndexOf(a,k-s))!=-1:(o=p.indexOf(a,k))!=-1)return{from:{node:i,offset:o},to:{node:i,offset:o+s}}}:function(g,i,k){var p=g?h.length-1:0,s=h[p],o=e(i),q=g?o.indexOf(s)+s.length:o.lastIndexOf(s);if(!(g?q>=k||q!=s.length:q<=k||q!=o.length-s.length))for(k=i;;){if(g&&!k)return;k=g?this.history.nodeBefore(k):this.history.nodeAfter(k);
if(!g&&!k)return;o=e(k);s=h[g?--p:++p];if(p>0&&p<h.length-1)if(o!=s)return;else continue;p=g?o.lastIndexOf(s):o.indexOf(s)+s.length;if(g?p!=o.length-s.length:p!=s.length)return;return{from:{node:g?k:i,offset:g?p:q},to:{node:g?i:k,offset:g?q:p}}}}}function u(b){this.options=b;window.indentUnit=b.indentUnit;this.parent=parent;this.doc=document;var a=this.container=this.doc.body;this.win=window;this.history=new UndoHistory(a,b.undoDepth,b.undoDelay,this);var d=this;if(!u.Parser)throw"No parser loaded.";
b.parserConfig&&u.Parser.configure&&u.Parser.configure(b.parserConfig);b.readOnly||select.setCursorPos(a,{node:null,offset:0});this.dirty=[];this.importCode(b.content||"");this.history.onChange=b.onChange;if(b.readOnly){if(!b.textWrapping)a.style.whiteSpace="nowrap"}else{if(b.continuousScanning!==false){this.scanner=this.documentScanner(b.passTime);this.delayScanning()}var c=function(){if(document.body.contentEditable!=undefined&&internetExplorer)document.body.contentEditable="true";else document.designMode=
"on";if(internetExplorer&&b.height!="dynamic")document.body.style.minHeight=b.height;document.documentElement.style.borderWidth="0";if(!b.textWrapping)a.style.whiteSpace="nowrap"};try{c()}catch(e){var h=addEventHandler(document,"focus",function(){h();c()},true)}addEventHandler(document,"keydown",method(this,"keyDown"));addEventHandler(document,"keypress",method(this,"keyPress"));addEventHandler(document,"keyup",method(this,"keyUp"));var g=function(){d.cursorActivity(false)};addEventHandler(document.body,
"mouseup",g);addEventHandler(document.body,"cut",g);gecko&&addEventHandler(this.win,"pagehide",function(){d.unloaded=true});addEventHandler(document.body,"paste",function(i){g();var k=null;try{var p=i.clipboardData||window.clipboardData;if(p)k=p.getData("Text")}catch(s){}if(k!==null){i.stop();d.replaceSelection(k);select.scrollToCursor(d.container)}});this.options.autoMatchParens&&addEventHandler(document.body,"click",method(this,"scheduleParenHighlight"))}}var v={P:true,DIV:true,LI:true};r.prototype=
{findNext:function(){return this.find(false)},findPrevious:function(){return this.find(true)},find:function(b){function a(){var g={node:e,offset:h};d.pos={from:g,to:g};return d.atOccurrence=false}if(!this.valid)return false;var d=this,c=b?this.pos.from:this.pos.to,e=c.node,h=c.offset;if(e&&!e.parentNode){e=null;h=0}for(;;){if(this.pos=this.matches(b,e,h))return this.atOccurrence=true;if(b){if(!e)return a();e=this.history.nodeBefore(e);h=this.history.textAfter(e).length}else{c=this.history.nodeAfter(e);
if(!c){h=this.history.textAfter(e).length;return a()}e=c;h=0}}},select:function(){if(this.atOccurrence){select.setCursorPos(this.editor.container,this.pos.from,this.pos.to);select.scrollToCursor(this.editor.container)}},replace:function(b){if(this.atOccurrence){this.pos.to=this.editor.replaceRange(this.pos.from,this.pos.to,b);this.atOccurrence=false}},position:function(){if(this.atOccurrence)return{line:this.pos.from.node,character:this.pos.from.offset}}};u.prototype={importCode:function(b){this.history.push(null,
null,f(b));this.history.reset()},getCode:function(){if(!this.container.firstChild)return"";var b=[];select.markSelection(this.win);forEach(j(this.container.firstChild),method(b,"push"));select.selectMarked();return cleanText(b.join(""))},checkLine:function(b){if(b===false||!(b==null||b.parentNode==this.container))throw parent.CodeMirror.InvalidLineHandle;},cursorPosition:function(b){if(b==null)b=true;return(b=select.cursorPos(this.container,b))?{line:b.node,character:b.offset}:{line:null,character:0}},
firstLine:function(){return null},lastLine:function(){return this.container.lastChild?m(this.container.lastChild):null},nextLine:function(b){this.checkLine(b);return n(b,this.container)||false},prevLine:function(b){this.checkLine(b);if(b==null)return false;return m(b.previousSibling)},visibleLineCount:function(){for(var b=this.container.firstChild;b&&isBR(b);)b=b.nextSibling;if(!b)return false;return Math.floor((window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight)/
b.offsetHeight)},selectLines:function(b,a,d,c){this.checkLine(b);b={node:b,offset:a};a=null;if(c!==undefined){this.checkLine(d);a={node:d,offset:c}}select.setCursorPos(this.container,b,a);select.scrollToCursor(this.container)},lineContent:function(b){var a=[];for(b=b?b.nextSibling:this.container.firstChild;b&&!isBR(b);b=b.nextSibling)a.push(nodeText(b));return cleanText(a.join(""))},setLineContent:function(b,a){this.history.commit();this.replaceRange({node:b,offset:0},{node:b,offset:this.history.textAfter(b).length},
a);this.addDirtyNode(b);this.scheduleHighlight()},removeLine:function(b){for(var a=b?b.nextSibling:this.container.firstChild;a;){var d=a.nextSibling;removeElement(a);if(isBR(a))break;a=d}this.addDirtyNode(b);this.scheduleHighlight()},insertIntoLine:function(b,a,d){var c=null;if(a=="end")c=n(b,this.container);else for(var e=b?b.nextSibling:this.container.firstChild;e;e=e.nextSibling){if(a==0){c=e;break}var h=nodeText(e);if(h.length>a){c=e.nextSibling;d=h.slice(0,a)+d+h.slice(a);removeElement(e);break}a-=
h.length}a=f(d);d=this.container.ownerDocument;for(e=0;e<a.length;e++){e>0&&this.container.insertBefore(d.createElement("BR"),c);this.container.insertBefore(makePartSpan(a[e],d),c)}this.addDirtyNode(b);this.scheduleHighlight()},selectedText:function(){var b=this.history;b.commit();var a=select.cursorPos(this.container,true),d=select.cursorPos(this.container,false);if(!a||!d)return"";if(a.node==d.node)return b.textAfter(a.node).slice(a.offset,d.offset);var c=[b.textAfter(a.node).slice(a.offset)];for(a=
b.nodeAfter(a.node);a!=d.node;a=b.nodeAfter(a))c.push(b.textAfter(a));c.push(b.textAfter(d.node).slice(0,d.offset));return cleanText(c.join("\n"))},replaceSelection:function(b){this.history.commit();var a=select.cursorPos(this.container,true),d=select.cursorPos(this.container,false);if(a&&d){d=this.replaceRange(a,d,b);select.setCursorPos(this.container,d)}},cursorCoords:function(b){function a(i,k){var p=-(g.win.document.body.scrollTop||g.win.document.documentElement.scrollTop||0),s=-(g.win.document.body.scrollLeft||
g.win.document.documentElement.scrollLeft||0)+k;forEach([i,g.win.frameElement],function(o){for(;o;){s+=o.offsetLeft;p+=o.offsetTop;o=o.offsetParent}});return{x:s,y:p,yBot:p+i.offsetHeight}}function d(i,k){var p=h.createElement("SPAN");p.appendChild(h.createTextNode(i));try{return k(p)}finally{p.parentNode&&p.parentNode.removeChild(p)}}var c=select.cursorPos(this.container,b);if(!c)return null;b=c.offset;for(var e=c.node,h=this.win.document,g=this;b;){e=e?e.nextSibling:this.container.firstChild;c=
nodeText(e);if(b<c.length)return d(c.substr(0,b),function(i){i.style.position="absolute";i.style.visibility="hidden";i.className=e.className;g.container.appendChild(i);return a(e,i.offsetWidth)});b-=c.length}return e&&isSpan(e)?a(e,e.offsetWidth):e&&e.nextSibling&&isSpan(e.nextSibling)?a(e.nextSibling,0):d("\u200b",function(i){e?e.parentNode.insertBefore(i,e.nextSibling):g.container.insertBefore(i,g.container.firstChild);return a(i,0)})},reroutePasteEvent:function(){if(!(this.capturingPaste||window.opera)){this.capturingPaste=
true;var b=window.frameElement.CodeMirror.textareaHack;parent.focus();b.value="";b.focus();var a=this;this.parent.setTimeout(function(){a.capturingPaste=false;a.win.focus();a.selectionSnapshot&&a.win.select.setBookmark(a.container,a.selectionSnapshot);var d=b.value;if(d){a.replaceSelection(d);select.scrollToCursor(a.container)}},10)}},replaceRange:function(b,a,d){d=f(d);d[0]=this.history.textAfter(b.node).slice(0,b.offset)+d[0];var c=d[d.length-1];d[d.length-1]=c+this.history.textAfter(a.node).slice(a.offset);
a=this.history.nodeAfter(a.node);this.history.push(b.node,a,d);return{node:this.history.nodeBefore(a),offset:c.length}},getSearchCursor:function(b,a,d){return new r(this,b,a,d)},reindent:function(){this.container.firstChild&&this.indentRegion(null,this.container.lastChild)},reindentSelection:function(b){if(select.somethingSelected(this.win)){var a=select.selectionTopNode(this.container,true),d=select.selectionTopNode(this.container,false);a===false||d===false||this.indentRegion(a,d,b)}else this.indentAtCursor(b)},
grabKeys:function(b,a){this.frozen=b;this.keyFilter=a},ungrabKeys:function(){this.frozen="leave"},setParser:function(b,a){u.Parser=window[b];(a=a||this.options.parserConfig)&&u.Parser.configure&&u.Parser.configure(a);if(this.container.firstChild){forEach(this.container.childNodes,function(d){if(d.nodeType!=3)d.dirty=true});this.addDirtyNode(this.firstChild);this.scheduleHighlight()}},keyDown:function(b){if(this.frozen=="leave")this.keyFilter=this.frozen=null;if(this.frozen&&(!this.keyFilter||this.keyFilter(b.keyCode,
b))){b.stop();this.frozen(b)}else{var a=b.keyCode;this.delayScanning();this.options.autoMatchParens&&this.scheduleParenHighlight();if(a==13){if(b.ctrlKey&&!b.altKey)this.reparseBuffer();else{select.insertNewlineAtCursor(this.win);a=this.options.enterMode;if(a!="flat")this.indentAtCursor(a=="keep"?"keep":undefined);select.scrollToCursor(this.container)}b.stop()}else if(a==9&&this.options.tabMode!="default"&&!b.ctrlKey){this.handleTab(!b.shiftKey);b.stop()}else if(a==32&&b.shiftKey&&this.options.tabMode==
"default"){this.handleTab(true);b.stop()}else if(a==36&&!b.shiftKey&&!b.ctrlKey)this.home()&&b.stop();else if(a==35&&!b.shiftKey&&!b.ctrlKey)this.end()&&b.stop();else if(a==33&&!b.shiftKey&&!b.ctrlKey&&!gecko)this.pageUp()&&b.stop();else if(a==34&&!b.shiftKey&&!b.ctrlKey&&!gecko)this.pageDown()&&b.stop();else if((a==219||a==221)&&b.ctrlKey&&!b.altKey){this.highlightParens(b.shiftKey,true);b.stop()}else if(b.metaKey&&!b.shiftKey&&(a==37||a==39)){var d=select.selectionTopNode(this.container);if(!(d===
false||!this.container.firstChild)){if(a==37)select.focusAfterNode(m(d),this.container);else{a=n(d,this.container);select.focusAfterNode(a?a.previousSibling:this.container.lastChild,this.container)}b.stop()}}else if((b.ctrlKey||b.metaKey)&&!b.altKey)if(b.shiftKey&&a==90||a==89){select.scrollToNode(this.history.redo());b.stop()}else if(a==90||safari&&a==8){select.scrollToNode(this.history.undo());b.stop()}else if(a==83&&this.options.saveFunction){this.options.saveFunction();b.stop()}else a==86&&this.reroutePasteEvent()}},
keyPress:function(b){var a=this.options.electricChars&&u.Parser.electricChars,d=this;if(this.frozen&&(!this.keyFilter||this.keyFilter(b.keyCode||b.code,b))||b.code==13||b.code==9&&this.options.tabMode!="default"||b.code==32&&b.shiftKey&&this.options.tabMode=="default")b.stop();else if(a&&a.indexOf(b.character)!=-1)this.parent.setTimeout(function(){d.indentAtCursor(null)},0);else if(brokenOpera)if(b.code==8){var c=select.selectionTopNode(this.container);d=this;var e=c?c.nextSibling:this.container.firstChild;
c!==false&&e&&isBR(e)&&this.parent.setTimeout(function(){select.selectionTopNode(d.container)==e&&select.focusAfterNode(e.previousSibling,d.container)},20)}else if(b.code==46){c=select.selectionTopNode(this.container);d=this;c&&isBR(c)&&this.parent.setTimeout(function(){select.selectionTopNode(d.container)!=c&&select.focusAfterNode(c,d.container)},20)}},keyUp:function(b){this.cursorActivity(b.keyCode>=16&&b.keyCode<=18||b.keyCode>=33&&b.keyCode<=40)},indentLineAfter:function(b,a){function d(p){p=
p?p.nextSibling:c.container.firstChild;if(!p||!hasClass(p,"whitespace"))return null;return p}var c=this,e=d(b),h=0,g=e?e.currentText.length:0;if(a=="keep"){if(b){var i=d(m(b.previousSibling));if(i)h=i.currentText.length}}else{var k=e?e.nextSibling:b?b.nextSibling:this.container.firstChild;i=b&&k&&k.currentText?k.currentText:"";if(a!=null&&this.options.tabMode=="shift")h=a?g+indentUnit:Math.max(0,g-indentUnit);else if(b)h=b.indentation(i,g,a);else if(u.Parser.firstIndentation)h=u.Parser.firstIndentation(i,
g,a)}g=h-g;if(g<0)if(h==0){if(k)select.snapshotMove(e.firstChild,k.firstChild||k,0);removeElement(e);e=null}else{select.snapshotMove(e.firstChild,e.firstChild,g,true);e.currentText=makeWhiteSpace(h);e.firstChild.nodeValue=e.currentText}else if(g>0)if(e){e.currentText=makeWhiteSpace(h);e.firstChild.nodeValue=e.currentText;select.snapshotMove(e.firstChild,e.firstChild,g,true)}else{e=makePartSpan(makeWhiteSpace(h),this.doc);e.className="whitespace";b?insertAfter(e,b):this.container.insertBefore(e,this.container.firstChild);
select.snapshotMove(k&&(k.firstChild||k),e.firstChild,h,false,true)}else e&&select.snapshotMove(e.firstChild,e.firstChild,h,false);g!=0&&this.addDirtyNode(b)},highlightAtCursor:function(){var b=select.selectionTopNode(this.container,true),a=select.selectionTopNode(this.container,false);if(b===false||a===false)return false;select.markSelection(this.win);if(this.highlight(b,n(a,this.container),true,20)===false)return false;select.selectMarked();return true},handleTab:function(b){this.options.tabMode==
"spaces"?select.insertTabAtCursor(this.win):this.reindentSelection(b)},home:function(){var b=select.selectionTopNode(this.container,true),a=b;if(b===false||!(!b||b.isPart||isBR(b))||!this.container.firstChild)return false;for(;b&&!isBR(b);)b=b.previousSibling;var d=b?b.nextSibling:this.container.firstChild;d&&d!=a&&d.isPart&&hasClass(d,"whitespace")?select.focusAfterNode(d,this.container):select.focusAfterNode(b,this.container);select.scrollToCursor(this.container);return true},end:function(){var b=
select.selectionTopNode(this.container,true);if(b===false)return false;b=n(b,this.container);if(!b)return false;select.focusAfterNode(b.previousSibling,this.container);select.scrollToCursor(this.container);return true},pageUp:function(){var b=this.cursorPosition().line,a=this.visibleLineCount();if(b===false||a===false)return false;a-=2;for(var d=0;d<a;d++){b=this.prevLine(b);if(b===false)break}if(d==0)return false;select.setCursorPos(this.container,{node:b,offset:0});select.scrollToCursor(this.container);
return true},pageDown:function(){var b=this.cursorPosition().line,a=this.visibleLineCount();if(b===false||a===false)return false;a-=2;for(var d=0;d<a;d++){var c=this.nextLine(b);if(c===false)break;b=c}if(d==0)return false;select.setCursorPos(this.container,{node:b,offset:0});select.scrollToCursor(this.container);return true},scheduleParenHighlight:function(){this.parenEvent&&this.parent.clearTimeout(this.parenEvent);var b=this;this.parenEvent=this.parent.setTimeout(function(){b.highlightParens()},
300)},highlightParens:function(b,a){function d(q,x){if(q)if(g.options.markParen)g.options.markParen(q,x);else{q.style.fontWeight="bold";q.style.color=x?"#8F8":"#F88"}}function c(q){if(q)if(g.options.unmarkParen)g.options.unmarkParen(q);else{q.style.fontWeight="";q.style.color=""}}function e(q){if(q.currentText)return(q=q.currentText.match(/^[\s\u00a0]*([\(\)\[\]{}])[\s\u00a0]*$/))&&q[1]}function h(){for(var q=[],x,y=true,t=k;t;t=s?t.nextSibling:t.previousSibling)if(t.className==p&&isSpan(t)&&(x=e(t))){if(/[\(\[\{]/.test(x)==
s)q.push(x);else if(q.length){if(q.pop()!=matching[x])y=false}else y=false;if(!q.length)break}else if(t.dirty||!isSpan(t)&&!isBR(t))return{node:t,status:"dirty"};return{node:t,status:t&&y}}var g=this;if(!a&&g.highlighted){c(g.highlighted[0]);c(g.highlighted[1])}if(window.select){this.parenEvent&&this.parent.clearTimeout(this.parenEvent);this.parenEvent=null;var i,k=select.selectionTopNode(this.container,true);if(k&&this.highlightAtCursor())if((k=select.selectionTopNode(this.container,true))&&((i=
e(k))||(k=k.nextSibling)&&(i=e(k))))for(var p=k.className,s=/[\(\[\{]/.test(i);;){var o=h();if(o.status=="dirty"){this.highlight(o.node,n(o.node));o.node.dirty=false}else{d(k,o.status);d(o.node,o.status);if(a)g.parent.setTimeout(function(){c(k);c(o.node)},500);else g.highlighted=[k,o.node];b&&o.node&&select.focusAfterNode(o.node.previousSibling,this.container);break}}}},indentAtCursor:function(b){if(this.container.firstChild)if(this.highlightAtCursor()){var a=select.selectionTopNode(this.container,
false);if(a!==false){select.markSelection(this.win);this.indentLineAfter(m(a),b);select.selectMarked()}}},indentRegion:function(b,a,d){var c=b=m(b),e=b&&m(b.previousSibling);isBR(a)||(a=n(a,this.container));this.addDirtyNode(b);do{var h=n(c,this.container);c&&this.highlight(e,h,true);this.indentLineAfter(c,d);e=c;c=h}while(c!=a);select.setCursorPos(this.container,{node:b,offset:0},{node:a,offset:0})},cursorActivity:function(b){if(this.unloaded){this.win.document.designMode="off";this.win.document.designMode=
"on";this.unloaded=false}if(internetExplorer){this.container.createTextRange().execCommand("unlink");this.selectionSnapshot=select.getBookmark(this.container)}var a=this.options.cursorActivity;if(!b||a){var d=select.selectionTopNode(this.container,false);if(!(d===false||!this.container.firstChild)){d=d||this.container.firstChild;a&&a(d);if(!b){this.scheduleHighlight();this.addDirtyNode(d)}}}},reparseBuffer:function(){forEach(this.container.childNodes,function(b){b.dirty=true});this.container.firstChild&&
this.addDirtyNode(this.container.firstChild)},addDirtyNode:function(b){if(b=b||this.container.firstChild){for(var a=0;a<this.dirty.length;a++)if(this.dirty[a]==b)return;if(b.nodeType!=3)b.dirty=true;this.dirty.push(b)}},allClean:function(){return!this.dirty.length},scheduleHighlight:function(){var b=this;this.parent.clearTimeout(this.highlightTimeout);this.highlightTimeout=this.parent.setTimeout(function(){b.highlightDirty()},this.options.passDelay)},getDirtyNode:function(){for(;this.dirty.length>
0;){var b=this.dirty.pop();try{for(;b&&b.parentNode!=this.container;)b=b.parentNode;if(b&&(b.dirty||b.nodeType==3))return b}catch(a){}}return null},highlightDirty:function(b){if(!window.select)return false;this.options.readOnly||select.markSelection(this.win);for(var a,d=b?null:(new Date).getTime()+this.options.passTime;((new Date).getTime()<d||b)&&(a=this.getDirtyNode());){var c=this.highlight(a,d);c&&c.node&&c.dirty&&this.addDirtyNode(c.node.nextSibling)}this.options.readOnly||select.selectMarked();
a&&this.scheduleHighlight();return this.dirty.length==0},documentScanner:function(b){var a=this,d=null;return function(){if(window.select){if(d&&d.parentNode!=a.container)d=null;select.markSelection(a.win);var c=a.highlight(d,(new Date).getTime()+b,true);select.selectMarked();c=c?c.node&&c.node.nextSibling:null;d=d==c?null:c;a.delayScanning()}}},delayScanning:function(){if(this.scanner){this.parent.clearTimeout(this.documentScan);this.documentScan=this.parent.setTimeout(this.scanner,this.options.continuousScanning)}},
highlight:function(b,a,d,c){function e(t){if(t){var w=t.oldNextSibling;if(q||w===undefined||t.nextSibling!=w)g.history.touch(t);t.oldNextSibling=t.nextSibling}else{w=g.container.oldFirstChild;if(q||w===undefined||g.container.firstChild!=w)g.history.touch(null);g.container.oldFirstChild=g.container.firstChild}}var h=this.container,g=this,i=this.options.activeTokens,k=typeof a=="number"?a:null;if(!h.firstChild)return false;for(;b&&(!b.parserFromHere||b.dirty);){if(c!=null&&isBR(b)&&--c<0)return false;
b=b.previousSibling}if(b&&!b.nextSibling)return false;var p=j(b?b.nextSibling:h.firstChild);c=stringStream(p);var s=b?b.parserFromHere(c):u.Parser.make(c),o={current:null,get:function(){if(!this.current)this.current=p.nodes.shift();return this.current},next:function(){this.current=null},remove:function(){h.removeChild(this.get());this.current=null},getNonEmpty:function(){for(var t=this.get();t&&isSpan(t)&&t.currentText=="";)if(window.opera&&(t.previousSibling==null||isBR(t.previousSibling))&&(t.nextSibling==
null||isBR(t.nextSibling))){this.next();t=this.get()}else{var w=t;this.remove();t=this.get();select.snapshotMove(w.firstChild,t&&(t.firstChild||t),0)}return t}},q=false,x=true,y=0;forEach(s,function(t){var w=o.getNonEmpty();if(t.value=="\n"){if(!isBR(w))throw"Parser out of sync. Expected BR.";if(w.dirty||!w.indentation)q=true;e(b);b=w;w.parserFromHere=s.copy();w.indentation=t.indentation;w.dirty=false;if(k==null&&w==a)throw StopIteration;if(k!=null&&(new Date).getTime()>=k||!q&&!x&&y>1&&!d)throw StopIteration;
x=q;q=false;y=0;o.next()}else{if(!isSpan(w))throw"Parser out of sync. Expected SPAN.";if(w.dirty)q=true;y++;if(!w.reduced&&w.currentText==t.value&&w.className==t.style){w.dirty=false;o.next()}else{q=true;var z=makePartSpan(t.value,g.doc);z.className=t.style;h.insertBefore(z,w);i&&i(z,t,g);t=t.value.length;for(var B=0;t>0;){w=o.get();var A=w.currentText.length;select.snapshotReplaceNode(w.firstChild,z.firstChild,t,B);if(A>t){w=w;w.currentText=w.currentText.substring(t);w.reduced=true;t=0}else{t-=A;
B+=A;o.remove()}}}}});e(b);return{node:o.getNonEmpty(),dirty:q}}};return u}();addEventHandler(window,"load",function(){var f=window.frameElement.CodeMirror;f.editor=new Editor(f.options);this.parent.setTimeout(method(f,"init"),0)});function tokenizer(f,l){function j(n){return n!="\n"&&/^[\s\u00a0]*$/.test(n)}var m={state:l,take:function(n){if(typeof n=="string")n={style:n,type:n};n.content=(n.content||"")+f.get();/\n$/.test(n.content)||f.nextWhile(j);n.value=n.content+f.get();return n},next:function(){if(!f.more())throw StopIteration;var n;if(f.equals("\n")){f.next();return this.take("whitespace")}if(f.applies(j))n="whitespace";else for(;!n;)n=this.state(f,function(r){m.state=r});return this.take(n)}};return m};
